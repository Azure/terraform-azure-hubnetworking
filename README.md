# Project

> This repo has been populated by an initial template to help get you started. Please
> make sure to update the content to build a great experience for community-building.

As the maintainer of this project, please make a few updates:

- Improving this README.MD file to provide a great experience
- Updating SUPPORT.MD with content about this project's support experience
- Understanding the security reporting process in SECURITY.MD
- Remove this section from the README

## Contributing

This project welcomes contributions and suggestions.  Most contributions require you to agree to a
Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us
the rights to use your contribution. For details, visit https://cla.opensource.microsoft.com.

When you submit a pull request, a CLA bot will automatically determine whether you need to provide
a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions
provided by the bot. You will only need to do this once across all repos using our CLA.

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).
For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or
contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.

## Trademarks

This project may contain trademarks or logos for projects, products, or services. Authorized use of Microsoft
trademarks or logos is subject to and must follow
[Microsoft's Trademark & Brand Guidelines](https://www.microsoft.com/en-us/legal/intellectualproperty/trademarks/usage/general).
Use of Microsoft trademarks or logos in modified versions of this project must not cause confusion or imply Microsoft sponsorship.
Any use of third-party trademarks or logos are subject to those third-party's policies.

<!-- BEGIN_TF_DOCS -->
## Requirements

| Name                                                                      | Version         |
|---------------------------------------------------------------------------|-----------------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.3.0        |
| <a name="requirement_azurerm"></a> [azurerm](#requirement\_azurerm)       | >= 3.7.0, < 4.0 |

## Providers

| Name                                                          | Version         |
|---------------------------------------------------------------|-----------------|
| <a name="provider_azurerm"></a> [azurerm](#provider\_azurerm) | >= 3.7.0, < 4.0 |

## Modules

| Name                                                                                                 | Source                | Version |
|------------------------------------------------------------------------------------------------------|-----------------------|---------|
| <a name="module_hub_virtual_networks"></a> [hub\_virtual\_networks](#module\_hub\_virtual\_networks) | Azure/subnets/azurerm | 1.0.0   |

## Resources

| Name                                                                                                                                                                                | Type     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|
| [azurerm_firewall.fw](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/firewall)                                                                     | resource |
| [azurerm_management_lock.rg_lock](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/management_lock)                                                  | resource |
| [azurerm_public_ip.fw_default_ip_configuration_pip](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/public_ip)                                      | resource |
| [azurerm_resource_group.rg](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/resource_group)                                                         | resource |
| [azurerm_route_table.hub_routing](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/route_table)                                                      | resource |
| [azurerm_subnet.fw_subnet](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/subnet)                                                                  | resource |
| [azurerm_subnet_route_table_association.fw_subnet_routing_creat](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/subnet_route_table_association)    | resource |
| [azurerm_subnet_route_table_association.fw_subnet_routing_external](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/subnet_route_table_association) | resource |
| [azurerm_subnet_route_table_association.hub_routing_creat](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/subnet_route_table_association)          | resource |
| [azurerm_subnet_route_table_association.hub_routing_external](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/subnet_route_table_association)       | resource |
| [azurerm_virtual_network_peering.hub_peering](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_network_peering)                              | resource |

## Inputs

| Name                                                                                               | Description                             | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Default | Required |
|----------------------------------------------------------------------------------------------------|-----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|:--------:|
| <a name="input_hub_virtual_networks"></a> [hub\_virtual\_networks](#input\_hub\_virtual\_networks) | A map of hub virtual networks to create | <pre>map(object({<br>    name                = string<br>    address_space      = list(string)<br>    location            = string<br>    resource_group_name = string<br><br>    bgp_community                   = optional(string)<br>    ddos_protection_plan_id         = optional(string)<br>    dns_servers                     = optional(list(string))<br>    flow_timeout_in_minutes         = optional(number, 4)<br>    mesh_peering_enabled            = optional(bool, true) # peer to other hub networks with this flag enabled?<br>    resource_group_creation_enabled = optional(bool, true) # use existing RG or create new<br>    resource_group_lock_enabled     = optional(bool, true) # enable CanNotDelete lock<br>    resource_group_lock_name        = optional(string)<br>    resource_group_tags             = optional(map(string))<br>    routing_address_space           = optional(list(string), [])<br>    # used to create route table entries for other hub networks<br>    hub_router_ip_address = optional(string)<br>    # Optional if using 3rd party NVAs, if not specified will use Azure Firewall address if enabled<br>    tags = optional(map(string), {})<br><br>    route_table_entries = optional(map(object({<br>      # additional entries for this hub's route table<br>      name           = string<br>      address_prefix = string<br>      next_hop_type  = string # Possible values: Internet, VirtualAppliance, VirtualNetworkGateway, VnetLocal, None<br><br>      has_bgp_override    = optional(bool, false)<br>      next_hop_ip_address = optional(string) # only required if next_hop_type is VirtualAppliance<br>    })), {})<br><br>    subnets = optional(map(object(<br>      {<br>        address_prefixes = list(string) # (Required) The address prefixes to use for the subnet.<br>        nat_gateway = optional(object({<br>          id = string<br>          # (Required) The ID of the NAT Gateway which should be associated with the Subnet. Changing this forces a new resource to be created.<br>        }))<br>        network_security_group = optional(object({<br>          id = string<br>          # (Required) The ID of the Network Security Group which should be associated with the Subnet. Changing this forces a new association to be created.<br>        }))<br>        private_endpoint_network_policies_enabled = optional(bool, true)<br>        # (Optional) Enable or Disable network policies for the private endpoint on the subnet. Setting this to true will Enable the policy and setting this to false will Disable the policy. Defaults to true.<br>        private_link_service_network_policies_enabled = optional(bool, true)<br>        # (Optional) Enable or Disable network policies for the private link service on the subnet. Setting this to true will Enable the policy and setting this to false will Disable the policy. Defaults to true.<br>        assign_generated_route_table = optional(bool, true)<br>        # (Optional) Should the Route Table generated by this module be associated with this Subnet? Defaults to true. Cannot be used with external_route_table<br>        external_route_table_id = optional(string)<br>        # The ID of the Route Table which should be associated with the Subnet. Changing this forces a new association to be created. Cannot be used with assign_generated_route_table<br>        service_endpoints = optional(set(string))<br>        # (Optional) The list of Service endpoints to associate with the subnet. Possible values include: Microsoft.AzureActiveDirectory, Microsoft.AzureCosmosDB, Microsoft.ContainerRegistry, Microsoft.EventHub, Microsoft.KeyVault, Microsoft.ServiceBus, Microsoft.Sql, Microsoft.Storage and Microsoft.Web.<br>        service_endpoint_policy_ids = optional(set(string))<br>        # (Optional) The list of IDs of Service Endpoint Policies to associate with the subnet.<br>        delegations = optional(list(<br>          object(<br>            {<br>              name = string # (Required) A name for this delegation.<br>              service_delegation = object({<br>                name = string<br>                # (Required) The name of service to delegate to. Possible values include Microsoft.ApiManagement/service, Microsoft.AzureCosmosDB/clusters, Microsoft.BareMetal/AzureVMware, Microsoft.BareMetal/CrayServers, Microsoft.Batch/batchAccounts, Microsoft.ContainerInstance/containerGroups, Microsoft.ContainerService/managedClusters, Microsoft.Databricks/workspaces, Microsoft.DBforMySQL/flexibleServers, Microsoft.DBforMySQL/serversv2, Microsoft.DBforPostgreSQL/flexibleServers, Microsoft.DBforPostgreSQL/serversv2, Microsoft.DBforPostgreSQL/singleServers, Microsoft.HardwareSecurityModules/dedicatedHSMs, Microsoft.Kusto/clusters, Microsoft.Logic/integrationServiceEnvironments, Microsoft.MachineLearningServices/workspaces, Microsoft.Netapp/volumes, Microsoft.Network/managedResolvers, Microsoft.Orbital/orbitalGateways, Microsoft.PowerPlatform/vnetaccesslinks, Microsoft.ServiceFabricMesh/networks, Microsoft.Sql/managedInstances, Microsoft.Sql/servers, Microsoft.StoragePool/diskPools, Microsoft.StreamAnalytics/streamingJobs, Microsoft.Synapse/workspaces, Microsoft.Web/hostingEnvironments, Microsoft.Web/serverFarms, NGINX.NGINXPLUS/nginxDeployments and PaloAltoNetworks.Cloudngfw/firewalls.<br>                actions = optional(list(string))<br>                # (Optional) A list of Actions which should be delegated. This list is specific to the service to delegate to. Possible values include Microsoft.Network/networkinterfaces/*, Microsoft.Network/virtualNetworks/subnets/action, Microsoft.Network/virtualNetworks/subnets/join/action, Microsoft.Network/virtualNetworks/subnets/prepareNetworkPolicies/action and Microsoft.Network/virtualNetworks/subnets/unprepareNetworkPolicies/action.<br>              })<br>            }<br>          )<br>        ))<br>      }<br>    )), {})<br><br>    # TODO: Firewall variables<br>    firewall = object({<br>      sku_name              = string<br>      sku_tier              = string<br>      subnet_address_prefix = string<br>      subnet_route_table_id = optional(string)<br>      name                  = optional(string)<br>      dns_servers           = optional(list(string))<br>      firewall_policy_id    = optional(string)<br>      private_ip_ranges     = optional(list(string))<br>      threat_intel_mode     = optional(string, "Alert")<br>      zones                 = optional(list(string))<br>      tags                  = optional(map(string))<br>      default_ip_configuration = optional(object({<br>        name = optional(string)<br>        public_ip_config = optional(object({<br>          name       = optional(set(string))<br>          zones      = optional(set(string))<br>          ip_version = optional(string)<br>          sku_tier   = optional(string, "Regional")<br>        }))<br>      }))<br>    })<br><br>    # TODO: ERGW variables<br><br>    # TODO: VPNGW variables<br>  }))</pre> | `{}`    |    no    |

## Outputs

| Name                                                                                     | Description |
|------------------------------------------------------------------------------------------|-------------|
| <a name="output_firewalls"></a> [firewalls](#output\_firewalls)                          | n/a         |
| <a name="output_hub_route_tables"></a> [hub\_route\_tables](#output\_hub\_route\_tables) | n/a         |
| <a name="output_resource_groups"></a> [resource\_groups](#output\_resource\_groups)      | n/a         |
| <a name="output_virtual_networks"></a> [virtual\_networks](#output\_virtual\_networks)   | n/a         |
<!-- END_TF_DOCS -->
